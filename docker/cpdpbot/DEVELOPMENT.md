# Development

- Make sure you have revealed secrets (`git secret reveal`)
- Download and install [Microsoft Azure Storage Explorer](https://azure.microsoft.com/en-us/features/storage-explorer/). This is the tool to push message into queue and test that it works for your twitterbot.
- In Azure Storage Explorer, log into storage account using `AZURE_STORAGE_ACCOUNT_NAME` and `AZURE_STORAGE_ACCOUNT_KEY` in `local.env`
- `docker-compose build`
- Run the cpdpbot: `docker-compose up cpdpbot` - Logs should show up for you now.
- In Azure Storage Explorer, there should be a queue named `cpdpbot` created within the storage account that you logged in as. Add a message like this and it should be processed by cpdpbot
```
{"id":12074,"percentiles":[{"percentile_allegation_civilian":"96.3319","year":2001,"id":12074,"percentile_allegation_internal":"0.0000","percentile_allegation":"99.0474"},{"percentile_allegation_civilian":"98.8638","year":2002,"id":12074,"percentile_allegation_internal":"94.6331","percentile_allegation":"99.8386"},{"percentile_allegation_civilian":"99.9225","year":2003,"id":12074,"percentile_allegation_internal":"97.6635","percentile_allegation":"99.9907"},{"percentile_allegation_civilian":"99.9498","year":2004,"id":12074,"percentile_allegation_internal":"96.5918","percentile_allegation":"99.9909"},{"percentile_trr":"83.5505","percentile_allegation_civilian":"99.9513","id":12074,"year":2005,"percentile_allegation":"99.9867","percentile_allegation_internal":"95.3297"},{"percentile_trr":"90.5453","percentile_allegation_civilian":"99.9705","id":12074,"year":2006,"percentile_allegation":"99.9913","percentile_allegation_internal":"98.5818"},{"percentile_trr":"87.1220","percentile_allegation_civilian":"99.9660","id":12074,"year":2007,"percentile_allegation":"99.9874","percentile_allegation_internal":"98.0650"},{"percentile_trr":"82.6006","percentile_allegation_civilian":"99.9667","id":12074,"year":2008,"percentile_allegation":"99.9793","percentile_allegation_internal":"98.5728"},{"percentile_trr":"78.7633","percentile_allegation_civilian":"99.9504","id":12074,"year":2009,"percentile_allegation":"99.9629","percentile_allegation_internal":"98.3178"},{"percentile_trr":"75.5037","percentile_allegation_civilian":"99.9398","id":12074,"year":2010,"percentile_allegation":"99.9672","percentile_allegation_internal":"98.1165"},{"percentile_trr":"76.6243","percentile_allegation_civilian":"99.9512","id":12074,"year":2011,"percentile_allegation":"99.9715","percentile_allegation_internal":"98.0757"}],"tweet":{"status":"Keith is bad!"}}
```
- Run test: `docker run -e "SETUP_LOGGING=no" --rm -v "$(pwd)/docker/cpdpbot:/app" cpdbv2_backend_cpdpbot python -m cpdpbot.test`
